import{i as A}from"./intro-0ca49f23.js";import{d as G,r as b,f as H,Z as I,o as M,c as O,a as s,_ as q}from"./index-5768c456.js";const F={class:"content-container"},U=["data-step","data-intro","data-position"],D={class:"opts"},P={for:"ipt"},T=["data-step","data-intro","data-position"],j=["data-step","data-intro","data-position"],z=G({__name:"Audio",setup(L){const p=b(),h=b();let m=!1,c=!1,l,f,i,n=99,y=!1,w;const u=["#33ccff","#ff99cc"];let _=u[0];const e={shifts:{step:"1",intro:"上传音频。",position:"top"},attendGroup:{step:"2",intro:"点击播放。",position:"top"},writeOff:{step:"3",intro:"实现音频可视化。",position:"bottom"}};H(()=>{localStorage.getItem("isShowHelp")==="1"&&(A.start(),A.onexit(function(){localStorage.setItem("isShowHelp","2")}))}),I(()=>{c=!1});const S=t=>{const o=t.target.files[0];if(o){const d=new FileReader;d.readAsDataURL(o),d.onload=function(r){var a;p.value.src=(a=r.target)==null?void 0:a.result}}},C=()=>{if(m){c=!0,clearTimeout(w),v();return}l=h.value.getContext("2d");const t=new AudioContext,o=t.createMediaElementSource(p.value);i=t.createAnalyser(),i.fftSize=512,f=new Uint8Array(i.frequencyBinCount),o.connect(i),i.connect(t.destination),m=!0,c=!0,v()},v=()=>{if(!m||!c)return;requestAnimationFrame(v);const{width:t,height:o}=h.value;l.clearRect(0,0,t,o),i.getByteFrequencyData(f);const d=f.length/2.5,r=t/d/2;l.fillStyle=_+Math.ceil(n),y?(n=n+.5,n===99&&(y=!1)):(n=n-.5,n===50&&(y=!0,_===u[0]?_=u[1]:_=u[0]));for(let a=0;a<d;a++){const g=f[a]/255*o,E=a*r+t/2,R=t/2-(a+1)*r,x=o-g;l.fillRect(E,x,r-3,g),l.fillRect(R,x,r-3,g)}},B=()=>{w=setTimeout(()=>{c=!1},2e3)},k=()=>{p.value.setAttribute("src","/mp3/juwairen.mp3")};return(t,o)=>(M(),O("div",F,[s("canvas",{ref_key:"cvs",ref:h,"data-step":e.writeOff.step,"data-intro":e.writeOff.intro,"data-position":e.writeOff.position,"data-disable-interaction":!0},null,8,U),s("div",D,[s("span",{class:"model",onClick:k},"样品"),s("label",P,[s("span",{class:"up","data-step":e.shifts.step,"data-intro":e.shifts.intro,"data-position":e.shifts.position,"data-disable-interaction":!0},"上传",8,T)]),s("audio",{ref_key:"audioEle",ref:p,src:"",controls:"",onPlay:C,onPause:B,"data-step":e.attendGroup.step,"data-intro":e.attendGroup.intro,"data-position":e.attendGroup.position,"data-disable-interaction":!0},null,40,j),s("input",{id:"ipt",type:"file",style:{display:"none"},onChange:S,accept:"audio/*,video/*"},null,32)])]))}});const Z=q(z,[["__scopeId","data-v-782f519e"]]);export{Z as default};
